<!DOCTYPE html>
<html>
<head>
<title>Advanced RSS using custom provider</title>
<script src="../Content/Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="../Content/Scripts/jquery.tmpl.min.js" type="text/javascript"></script>
<script src="../Content/Scripts/JayData.js" type="text/javascript"></script>
<script src="../Content/Scripts/JayDataModules/template.js" type="text/javascript"></script>
<script src="../Content/Scripts/bootstrap.min.js" type="text/javascript"></script>

<script src="RSSProvider.js" type="text/javascript"></script>

<link href="../Styles/Bootstrap/bootstrap.css" rel="stylesheet">
<link href="../Styles/Bootstrap/bootstrap-responsive.css" rel="stylesheet">
<link href="../Styles/Bootstrap/docs.css" rel="stylesheet">

<link href="../Styles/mixins.css" rel="stylesheet">
<link href="../Styles/dd.css" rel="stylesheet">
</head>
<body>
    <!-- Navbar ================================================== -->
    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                </a>
                <a class="brand" href="./index.html">Bootstrap</a>
                <div class="nav-collapse">
                <ul class="nav">
                    <li class="active">
                    <a href="/index.html">Examples home</a>
                    </li>
                    <li class="">
                    <a href="http://www.jaydata.org">JayData.org home</a>
                    </li>
                    <li class="">
                    <a href="http://www.jaydata.org/documentation">Documentation</a>
                    </li>
                    <li class="">
                    <a href="http://www.jaydata.org/community">Community</a>
                    </li>
                    <li class="">
                    <a href="http://www.jaydata.org/forum">Forum</a>
                    </li>
                    <li class="">
                    <a href="http://www.jaydata.org/blog">Blog</a>
                    </li>
                    <li class="">
                    <a href="http://www.jaydata.org/backlogs">Write a new userstory!</a>
                    </li>
                </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <header class="jumbotron masthead">
            <div class="inner tacenter">
                <h1>Advanced RSS using custom provider</h1>

                <div class="clear">
                    <h3 class="marginb5">Supported browsers:</h3>
                    <ul class="browser-list">
                        <li class="browser ie" title="Internet Explorer 9.0+"></li>
                        <li class="browser firefox" title="Firefox 10.0+"></li>
                        <li class="browser chrome" title="Google Chrome 12+"></li>
                        <li class="browser safari" title="Safari 4+"></li>
                        <li class="browser blackberry" title="Blackberry 7+"></li>
                        <li class="browser wp" title="Windows Phone 7.5+"></li>
                        <li class="browser ios" title="iOS 4+"></li>
                        <li class="browser android" title="Android 2.2+"></li>
                    </ul>
                </div>

                <hr class="soften" />

                    <h2>Converting <a class="tdunder" href="javascript.xml" title="javascript.xml" target="_blank">XML</a> to typed JSON using JayData Model Binder</h2>

                    <br />

                <div class="span5 reset-m">
                <h3>Extend the original RSS context<br /> with extended RSS Item element type</h3>
                <pre style='color:#000000;background:#ffffff;'>$data<span style='color:#808030; '>.</span>EntityContext<span style='color:#808030; '>.</span>extend<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'$data.RSS.RSSExtendedContext'</span><span style='color:#808030; '>,</span> <span style='color:#800080; '>{</span>
    Items<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span> type<span style='color:#800080; '>:</span> $data<span style='color:#808030; '>.</span>EntitySet<span style='color:#808030; '>,</span> elementType<span style='color:#800080; '>:</span> 
        $data<span style='color:#808030; '>.</span>RSS<span style='color:#808030; '>.</span>RSSItem<span style='color:#808030; '>.</span>extend<span style='color:#808030; '>(</span><span style='color:#0000e6; '>'$data.RSS.RSSExtendedItem'</span><span style='color:#808030; '>,</span> <span style='color:#800080; '>{</span>
        Category<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span> type<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'$data.Array'</span><span style='color:#808030; '>,</span> elementType<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'string'</span> <span style='color:#800080; '>}</span>
        <span style='color:#800080; '>}</span><span style='color:#808030; '>)</span> 
    <span style='color:#800080; '>}</span>
<span style='color:#800080; '>}</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
</pre>
                </div>

                <div class="span7 ">
                <h3>Use the model binder to map<br /> RSS fields to typed JSON data</h3>
                <pre style='color:#000000;background:#ffffff;'><span style='color:#800000; font-weight:bold; '>var</span> context <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> $data<span style='color:#808030; '>.</span>RSS<span style='color:#808030; '>.</span>RSSExtendedContext<span style='color:#808030; '>(</span><span style='color:#800080; '>{</span> name<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'RSS'</span><span style='color:#808030; '>,</span> url<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'javascript.xml'</span><span style='color:#808030; '>,</span> binder<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span>
    $type<span style='color:#800080; '>:</span> $data<span style='color:#808030; '>.</span><span style='color:#797997; '>Array</span><span style='color:#808030; '>,</span>
    $selector<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'xml:rss channel item'</span><span style='color:#808030; '>,</span>
    $<span style='color:#800000; font-weight:bold; '>item</span><span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span>
        $type<span style='color:#800080; '>:</span> $data<span style='color:#808030; '>.</span>RSS<span style='color:#808030; '>.</span>RSSExtendedItem<span style='color:#808030; '>,</span>
        Title<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span> $selector<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'xml:title'</span><span style='color:#808030; '>,</span> $<span style='color:#797997; '>source</span><span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'textContent'</span> <span style='color:#800080; '>}</span><span style='color:#808030; '>,</span>
        Description<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span> $selector<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'xml:description'</span><span style='color:#808030; '>,</span> $<span style='color:#797997; '>source</span><span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'textContent'</span> <span style='color:#800080; '>}</span><span style='color:#808030; '>,</span>
        Link<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span> $selector<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'xml:link'</span><span style='color:#808030; '>,</span> $<span style='color:#797997; '>source</span><span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'textContent'</span> <span style='color:#800080; '>}</span><span style='color:#808030; '>,</span>
        Guid<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span> $selector<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'xml:guid'</span><span style='color:#808030; '>,</span> $<span style='color:#797997; '>source</span><span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'textContent'</span> <span style='color:#800080; '>}</span><span style='color:#808030; '>,</span>
        PubDate<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span> $selector<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'xml:pubDate'</span><span style='color:#808030; '>,</span> $<span style='color:#797997; '>source</span><span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'textContent'</span> <span style='color:#800080; '>}</span><span style='color:#808030; '>,</span>
        Category<span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span>
            $type<span style='color:#800080; '>:</span> $data<span style='color:#808030; '>.</span><span style='color:#797997; '>Array</span><span style='color:#808030; '>,</span>
            $selector<span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'xml:category'</span><span style='color:#808030; '>,</span>
            $<span style='color:#800000; font-weight:bold; '>item</span><span style='color:#800080; '>:</span> <span style='color:#800080; '>{</span>
                $type<span style='color:#800080; '>:</span> $data<span style='color:#808030; '>.</span>String<span style='color:#808030; '>,</span>
                $<span style='color:#797997; '>source</span><span style='color:#800080; '>:</span> <span style='color:#0000e6; '>'textContent'</span>
            <span style='color:#800080; '>}</span>
        <span style='color:#800080; '>}</span>
    <span style='color:#800080; '>}</span>
<span style='color:#800080; '>}</span> <span style='color:#800080; '>}</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
</pre>
                </div>
            </div>
        </header>

        <hr class="soften" />

        <section id="wrapper" class="container iblock">
            <div id="result"></div>
            <script type="text/javascript">

                $(function(){

                    $data.EntityContext.extend('$data.RSS.RSSExtendedContext', {
                        Items: { type: $data.EntitySet, elementType: $data.RSS.RSSItem.extend('$data.RSS.RSSExtendedItem', {
                            Category: { type: '$data.Array', elementType: 'string' }
                        }) }
                    });

                    var context = new $data.RSS.RSSExtendedContext({ name: 'RSS', url: 'javascript.xml', binder: {
                        $type: $data.Array,
                        $selector: 'xml:rss channel item',
                        $item: {
                            $type: $data.RSS.RSSExtendedItem,
                            Title: { $selector: 'xml:title', $source: 'textContent' },
                            Description: { $selector: 'xml:description', $source: 'textContent' },
                            Link: { $selector: 'xml:link', $source: 'textContent' },
                            Guid: { $selector: 'xml:guid', $source: 'textContent' },
                            PubDate: { $selector: 'xml:pubDate', $source: 'textContent' },
                            Category: {
                                $type: $data.Array,
                                $selector: 'xml:category',
                                $item: {
                                    $type: $data.String,
                                    $source: 'textContent'
                                }
                            }
                        }
                    } });
                    context.onReady(function(rss){
                        rss.Items.tojQueryTemplate('#rssTemplate', '#result');
                    });

                });

            </script>
            <script id="rssTemplate" type="text/x-jquery-tmpl">
                <div class="rss-content-item">
                    <h2><a href="${Link}">${Title}</a></h2>
                    <span>Categories: <b>{{each Category}} {{if $index > 0}}, {{else}}{{/if}} ${$value}
                        {{/each}}</b></span>
                    <br />
                    <span>pubDate: ${PubDate}</span>
                    <br />
                    <span>guid: ${Guid}</span>
                    <p>description: {{html Description}}</p>
                </div>
            </script>
        </section>
    </div>
</body>
</html>
